---
layout: post
title: "공적분과 오차수정모형: 함께 움직이는 변수들의 분석"
date: 2025-10-17
categories: [Econometrics, Macroeconomics]
tags: [cointegration, VECM, unit root test, error correction model, econometrics]
math: true
---

## 1. 공적분과 오차수정모형

GDP, 소비, 물가 등 대부분의 거시경제 시계열 변수들은 시간이 지남에 따라 함께 증가하거나 감소하는 **공통된 추세**를 보입니다. 하지만 이처럼 각자 불안정한 시계열(non-stationary series) 변수들을 그대로 회귀분석에 사용하면, 실제로는 아무 인과관계가 없는데도 통계적으로 유의한 것처럼 보이는 **'허구적 회귀(spurious regression)'** 문제에 빠지기 쉽습니다.

그렇다면 이 변수들을 어떻게 분석해야 할까요? 해답은 변수들이 장기적으로 안정적인 '균형 관계'를 유지하며 함께 움직이는지를 살펴보는 **공적분(Cointegration)** 에서 찾을 수 있습니다. 예를 들어, 개인의 소득과 소비는 단기적으로 불일치할 수 있지만, 장기적으로는 서로를 떠나 멀리 벗어나지 않는 관계와 같습니다.

이제 두 변수가 이러한 공적분 관계에 있다는 것을 확인했다고 가정해 봅시다. 그렇다면 단기적으로 발생한 불균형은 미래에 어떻게 조정될까요?

바로 이 질문에 답하는 것이 **오차수정모형(Error Correction Model, ECM)** 입니다. ECM은 변수들이 장기 균형에서 일시적으로 벗어났을 때, 그 '오차'를 얼마나 빠른 속도로 '수정'하며 다시 균형을 찾아가는지 단기적 동학을 명쾌하게 분석합니다.

### 1-1. 핵심 아이디어

개별적으로는 불안정한 변수 $(Y_t, X_t)$들이 장기적으로 안정적인 균형 관계, 즉 **공적분 관계**를 가질 수 있습니다. Engle-Granger 방법은 먼저 이 장기 균형 관계를 추정한 뒤, 그 관계에서 벗어난 **'오차(잔차)'** 를 측정하고, 이 오차가 다시 균형으로 돌아가는 단기적 조정 과정을 모델링합니다.

### 1-2. 분석

구체적으로 어떻게 공적분 관계인지 확인하고 오차수정모형을 적용하는지 알아보겠습니다.

#### 1단계: 장기 균형 관계식 추정 및 잔차 계산

먼저, 변수 $Y_t$​를 $X_t$​에 대해 OLS 회귀분석을 실행하여 장기 균형 관계를 추정합니다.

$$
Y_t = \beta_0 + \beta_1 X_t + u_t
$$

여기서 얻은 잔차 $\hat{u}_t$를 계산합니다. 이 잔차가 바로 **'장기 균형에서 벗어난 정도(오차)'** 를 나타냅니다.

$$
\hat{u}_t = Y_t - \hat{\beta}_0 - \hat{\beta}_1 X_t
$$

#### 2단계: 잔차를 이용한 공적분 검정 및 오차수정모형(ECM) 구축

이제 1단계에서 구한 '오차'인 $\hat{u}_t$를 이용하여 두 가지 중요한 분석을 진행합니다.

##### 2-1단계: 공적분 검정 (Cointegration Test)

만약 두 변수가 정말 공적분 관계에 있다면, 장기 균형에서 벗어난 오차($\hat{u}_t$)는 영원히 발산하지 않고 결국 평균(0)으로 돌아오는 **안정적 시계열(stationary series)** 이어야 합니다. 따라서, 이 잔차 $\hat{u}_t$에 대해 **단위근 검정(Unit Root Test, e.g., ADF test)** 을 수행합니다.

* **귀무가설 ($H_0$)**: 잔차에 단위근이 존재한다. (잔차가 불안정하다) $\implies$ **공적분 관계가 없다.**
* **대립가설 ($H_1$)**: 잔차에 단위근이 없다. (잔차가 안정적이다) $\implies$ **공적분 관계가 있다.**

여기서 귀무가설을 기각하면, 두 변수 사이에 장기 균형 관계가 존재한다고 결론 내릴 수 있습니다.

##### 2-2단계: 오차수정모형(Error Correction Model, ECM) 구축

두 변수가 공적분 관계에 있다면, 단기적인 변화($\Delta Y_t$)는 장기 균형에서 벗어난 과거의 오차를 '수정(correct)'하려는 움직임을 보일 것이라고 모델링할 수 있습니다. 이때 **1단계에서 구한 잔차의 과거 값($\hat{u}_{t-1}$)** 을 '오차수정항'으로 하여 회귀분석에 포함시킵니다.

$$
\Delta Y_t = \alpha_0 + \gamma_1 \Delta X_t + \delta \hat{u}_{t-1} + \epsilon_t
$$

* $\Delta Y_t, \Delta X_t$ : 각 변수의 1차 차분 값으로, **단기적 변화**를 의미합니다.
* $\hat{u}_{t-1}$ : **오차수정항(Error Correction Term)**. 즉, 직전 시점$(t-1)$의 불균형의 크기를 나타냅니다.
* $\delta$ : **조정 속도(speed of adjustment)**. 이 계수는 보통 음수$(-)$ 값을 가집니다. 예를 들어 $\delta = -0.2$ 라면, 과거에 발생한 불균형의 20%가 현재 시점에서 균형 방향으로 조정된다는 의미입니다.

## 2. 다변량으로의 확장: 벡터 오차수정모형(VECM)

오차수정모형(ECM)이 주로 두 변수 간의 관계를 다룬다면, **VECM**은 이를 **세 개 이상의 변수가 있는 시스템으로 확장**한 모델입니다.

### 2-1. 핵심 아이디어

VECM은 여러 마리의 강아지들이 각자 목줄에 묶여 함께 산책하는 상황과 같습니다.  

* **각 강아지 (개별 시계열 변수)**: GDP, 소비, 투자 등 각 변수는 단기적으로 자유롭게 움직일 수 있습니다.
* **목줄 (장기 균형 관계 / 공적분)**: 하지만 변수들 사이에는 서로를 묶어주는 장기 균형 관계(공적분)가 있어, 서로에게서 너무 멀리 벗어날 수는 없습니다.
* **오차 수정 (Error Correction)**: 한 강아지가 너무 앞서나가면(오차가 발생하면), 목줄이 팽팽해지면서 속도를 늦추거나 다른 강아지들이 따라잡아(오차가 수정되어) 다시 적절한 거리를 유지하게 됩니다.

이처럼 VECM은 공적분 관계에 있는 여러 변수들이 단기적으로는 서로의 변화에 영향을 주고받으면서도, 장기적으로는 어떻게 안정적인 균형을 유지해 나가는지를 종합적으로 설명하는 강력한 분석 도구입니다.

### 2-2. VECM의 수학적 구조

VECM은 불안정적 시계열 벡터 $Y_t$에 대한 벡터 자기회귀 모형(VAR)을 다음과 같이 변형한 형태입니다.

$$
\Delta Y_t = \Pi Y_{t-1} + \Gamma_1 \Delta Y_{t-1} + \dots + \Gamma_{p-1} \Delta Y_{t-p+1} + \varepsilon_t
$$

* $\Delta Y_{t-i}$ : 과거 시점들의 **단기적 변화**가 현재의 단기적 변화($\Delta Y_t$)에 미치는 영향을 나타냅니다.
* $\Pi Y_{t-1}$ : 모델의 핵심인 **오차수정항**입니다. 과거 시점($t-1$)의 수준이 장기 균형에서 얼마나 벗어났는지가 현재의 변화에 영향을 미치는 효과를 담고 있습니다.

이 $\Pi$ 행렬은 두 행렬의 곱, $\Pi = \alpha\beta'$로 분해될 수 있습니다.

$$
\Pi Y_{t-1} = \alpha(\beta' Y_{t-1})
$$

* $\beta$ : **공적분 벡터(cointegrating vector)** 로, 변수들 간의 **장기 균형 관계**를 정의합니다. $\beta' Y_{t-1}$ 은 바로 과거 시점의 불균형(오차)을 나타내는 항입니다.
* $\alpha$ : **조정 계수(adjustment coefficient)** 벡터로, 장기 균형에서 벗어난 오차가 발생했을 때 각 변수가 균형으로 복귀하려는 **조정 속도**를 나타냅니다.

### 2-3. 공적분 관계는 어떻게 확인하는가? - 요한센 검정 (Johansen Test)

VECM을 사용하려면 먼저 변수들 사이에 공적분 관계가 있는지, 있다면 몇 개가 있는지 확인해야 합니다. 3개 이상의 변수 시스템에서는 **요한센 검정(Johansen Test)** 을 사용하는 것이 표준적인 방법입니다.

요한센 검정은 $\Pi$ 행렬의 계수(rank)를 분석하여 시스템 내에 존재하는 독립적인 장기 균형 관계($\beta$)의 개수를 통계적으로 검정합니다. 이 검정을 통해 공적분 관계의 개수가 0개라는 귀무가설을 기각하면, VECM을 사용할 수 있는 근거를 확보하게 됩니다.

## 3. VECM의 작동 원리를 구체적으로 살펴보기

앞서 말했듯이 VECM은 VAR(벡터 자기회귀 모형)을 변형한 아래와 같은 행렬식으로 표현됩니다.  

$$
\Delta Y_t = \Pi Y_{t-1} + \Gamma_1 \Delta Y_{t-1} + \dots + \Gamma_{p-1} \Delta Y_{t-p+1} + \varepsilon_t
$$

이 행렬식은 사실 **여러 개의 회귀방정식을 한 번에 표현한 시스템**입니다. 3개의 변수(GDP, 소비 C, 투자 I)가 공적분 관계에 있는 구체적인 예시를 통해 이 식을 풀어보겠습니다.

### 3-1. 벡터의 정의

먼저, VECM에 사용되는 벡터 $Y_t$는 시스템에 포함된 변수들로 이루어진 열벡터(column vector)입니다.

$$
Y_t =
\begin{pmatrix}
GDP_t \\
C_t \\
I_t
\end{pmatrix},
\quad
\Delta Y_t =
\begin{pmatrix}
\Delta GDP_t \\
\Delta C_t \\
\Delta I_t
\end{pmatrix}
$$

### 3-2 오차수정항 $(\Pi Y_{t-1})$ 의 해부

VECM의 핵심은 장기 균형에서 벗어난 오차를 수정하는 오차수정항입니다. 이 항은 $\Pi = \alpha\beta'$로 분해됩니다.

① 장기 균형 관계 $(\beta)$ 와 오차 $(\beta' Y_{t-1})$

* 공적분 벡터 $(\beta)$ 는 변수들 간의 장기 균형 관계를 정의합니다. 예를 들어, 시스템에 하나의 장기 균형 관계가 있다면 $\beta$는 다음과 같습니다. (첫 번째 변수를 1로 정규화)

$$
\beta =
\begin{pmatrix}
1 \\ -\beta_2 \\ -\beta_3
\end{pmatrix}
$$

* 이 벡터와 과거 변수 $Y_{t-1}$을 곱하면, 장기 균형에서 벗어난 '오차'를 나타내는 **하나의 값** $EC_{t-1}$이 계산됩니다.
  
$$
EC_{t-1} = \beta' Y_{t-1} \\
         = GDP_{t-1} - \beta_2 C_{t-1} - \beta_3 I_{t-1}
$$

여기서 $EC_{t-1}$이 바로 **과거 시점($t-1$)의 불균형** 입니다.

② 조정 속도 $(\alpha)$

* 조정 계수 벡터 $(\alpha)$ 는 각 변수가 이 불균형 $(EC_{t-1})$ 에 얼마나 빠르게 반응하여 균형으로 돌아가는지를 나타냅니다.

$$
\alpha =
\begin{pmatrix}
\alpha_{GDP} \\ \alpha_C \\ \alpha_I
\end{pmatrix}
$$

### 3-3. 완성된 VECM 회귀 방정식 시스템

이제 위 요소들을 결합하면, VECM 행렬식은 실제로는 다음과 같은 **3개의 회귀 방정식 시스템**을 의미하게 됩니다. (단순화를 위해 시차는 1개만 표시)

**[방정식 1: $\Delta GDP_t$에 대한 회귀식]**  

$$
\Delta GDP_t = \alpha_{GDP} (EC_{t-1}) + \gamma_{11} \Delta GDP_{t-1} + \gamma_{12} \Delta C_{t-1} + \gamma_{13} \Delta I_{t-1} + \varepsilon_{GDP,t}
$$

**[방정식 2: $\Delta C_t$에 대한 회귀식]**  

$$
\Delta C_t = \alpha_C (EC_{t-1}) + \gamma_{21} \Delta GDP_{t-1} + \gamma_{22} \Delta C_{t-1} + \gamma_{23} \Delta I_{t-1} + \varepsilon_{C,t}
$$

**[방정식 3: $\Delta I_t$에 대한 회귀식]**  

$$
\Delta I_t = \alpha_I (EC_{t-1}) + \gamma_{31} \Delta GDP_{t-1} + \gamma_{32} \Delta C_{t-1} + \gamma_{33} \Delta I_{t-1} + \varepsilon_{I,t}
$$

이렇게 보면 VECM이 각 변수의 단기적 변화($\Delta Y_t$)를 **(1) 과거의 불균형($EC_{t-1}$)에 대한 반응** 과 **(2) 다른 변수들의 과거 단기적 변화($\Delta Y_{t-i}$)에 대한 반응** 으로 설명하는 정교한 모델임이 명확해집니다.

실제 분석에서는 통계 패키지가 요한센 절차(Johansen procedure) 등을 통해 이 복잡한 시스템을 한 번에 추정하여 $\alpha$와 $\beta$ 값을 찾아줍니다.

## 4. 장기 균형과 단기 조정을 아우르는 통합된 분석

공적분과 오차수정모형은 단순히 불안정적 시계열 데이터의 허구적 회귀 문제를 해결하는 기술적 기법을 넘어섭니다. 이 방법론은 '변수들은 장기적으로 안정적인 균형을 찾아간다'는 강력한 경제학적 직관에 수학적 엄밀함을 부여합니다.

우리는 이 프레임워크를 통해 불안정한 데이터의 바다 속에서도 의미 있는 장기 균형 관계($\beta$)를 낚아챌 수 있습니다. 더 나아가 ECM과 VECM은 현실의 경제 주체들이 단기적 충격에 반응하며 그 균형에서 벗어났을 때, 어떤 속도($\alpha$)로 그리고 어떤 상호작용을 통해 균형점으로 복귀하는지를 역동적으로 그려냅니다.

결국 이 모델들은 복잡하게 얽혀 있는 거시경제 시스템의 **장기적 방향성** 과 **단기적 변동성**을 하나의 통합된 이야기로 풀어내는 강력한 서사 도구입니다.

---

_**출처: 대학원에서 본인의 Lecture Note - Macroeconometrics**_
